<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Screen A</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="welcome-container">
        <h1>Screen A</h1>

        <!-- Buttons -->
        <div class="button-row">
            <a href="page1.html"><button>Return</button></a>
            <button onclick="addRow()">Add Row</button>
            <button onclick="deleteRow()">Delete Last Row</button>
            <button onclick="clearTable()">Clear Table</button>
        </div>

        <!-- Table -->
       <table id="myTable" border="1" style="margin-top:20px;width:80%;text-align:center;">
    <tr>
        <th>Metal</th>
        <th>New sheets</th>
        <th>Size</th>
        <th>Thickness</th>
        <th>Warehouse</th>
    </tr>
</table>


    </div>

<script>

/* =========================
   LOAD CSV (only first time)
========================= */

const STORAGE_KEY = "inventoryTableData";

function loadCSV() {

  // If we already edited before, load saved version instead
  const saved = localStorage.getItem(STORAGE_KEY);
  if (saved) {
    buildTable(JSON.parse(saved));
    return;
  }

  fetch("Newsheets.csv")
    .then(response => response.text())
    .then(csv => {
      const rows = csv.trim().split("\n").map(r => r.split(","));
      buildTable(rows.slice(1)); // skip header
      saveTable(); // store initial data
    })
    .catch(err => console.error("CSV load error:", err));
}

/* =========================
   BUILD TABLE
========================= */

function buildTable(data) {
  const table = document.getElementById("myTable");

  while (table.rows.length > 1) table.deleteRow(1);

  data.forEach(r => {
    const tr = table.insertRow(-1);

    for (let i = 0; i < 5; i++) {
      const td = tr.insertCell(i);
      td.textContent = r[i] || "";
      td.contentEditable = "true"; // makes cells editable
    }
  });
}

/* =========================
   SAVE TABLE (AUTO SAVE)
========================= */

function saveTable() {
  const table = document.getElementById("myTable");
  let data = [];

  for (let i = 1; i < table.rows.length; i++) {
    const cells = table.rows[i].cells;
    data.push([
      cells[0].textContent.trim(),
      cells[1].textContent.trim(),
      cells[2].textContent.trim(),
      cells[3].textContent.trim(),
      cells[4].textContent.trim()
    ]);
  }

  localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
}

/* =========================
   BUTTON FUNCTIONS
========================= */

function addRow() {
  const table = document.getElementById("myTable");
  const row = table.insertRow(-1);

  for (let i = 0; i < 5; i++) {
    const td = row.insertCell(i);
    td.contentEditable = "true";
    td.textContent = "";
  }

  saveTable();
}

function deleteRow() {
  const table = document.getElementById("myTable");
  if (table.rows.length > 1) {
    table.deleteRow(-1);
    saveTable();
  }
}

function clearTable() {
  const table = document.getElementById("myTable");
  while (table.rows.length > 1) table.deleteRow(1);
  saveTable();
}

/* =========================
   AUTO-SAVE WHEN EDITING
========================= */

document.addEventListener("input", function(e) {
  if (e.target.closest("#myTable")) {
    saveTable();
  }
});

/* =========================
   START
========================= */

loadCSV();

</script>


</body>
</html>
